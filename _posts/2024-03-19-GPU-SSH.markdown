---
layout: post
title:  "快回来，组里发显卡了"
date:   2024-03-19 23:15:00 +0800
categories: posts
tag: util
---

<p><img src="{{site.url}}/images/gpu.png" width="75%" align="middle" /></p>

可以用组里的显卡采数据了！怕自己忘了怎么弄，在这里记录一下。

## Carla transfuser 数据采集

`transfuser` 的数据采集脚本在 `leaderboard/scripts/datagen.sh`，readme原文如下：

### Data generation
In addition to the dataset itself, we have provided the scripts for data generation with our autopilot agent. To generate data, the first step is to launch a CARLA server:

```Shell
./CarlaUE4.sh --world-port=2000 -opengl
```

For more information on running CARLA servers (e.g. on a machine without a display), see the [official documentation.](https://carla.readthedocs.io/en/stable/carla_headless/) Once the server is running, use the script below for generating training data:
```Shell
./leaderboard/scripts/datagen.sh <carla root> <working directory of this repo (*/transfuser/)>
```

The main variables to set for this script are `SCENARIOS` and `ROUTES`. 



实际上在运行脚本时terminal所在路径并不重要，只要

1. 运行`./CarlaUE4.sh --world-port=2000 -opengl`；

2. 运行`datagen.sh`，不用传入参数。

不过要确保 `datagen.sh` 中变量的正确性：

设置路径：

```bash
export CARLA_ROOT=${1:path/to/carla}
export WORK_DIR=${2:-/path/to/transfuser}
```

设置Town和Scenario：

```bash
export SCENARIOS=${WORK_DIR}/leaderboard/data/training/scenarios/Scenario10/Town05_Scenario10.json
export ROUTES=${WORK_DIR}/leaderboard/data/training/routes/Scenario10/Town05_Scenario10.xml
```

## 外接显卡

这时候就需要在带有显卡的服务器上跑自己的程序了。不过出现了一个小插曲：远程服务器的网络不似乎很顺畅，几乎没有办法用它自己下载任何东西。于是我们只好从自己的电脑传递文件过去。

由于可以使用ssh，于是使用 `scp` 进行传输。

传输文件夹：

```bash
scp -r /path/to/local/folder username@ipaddress:/path/to/remote/folder
```

其中 `-r` 表示 `recursive` ，即上传文件夹和文件夹里所有文件。

首先本地下载了`anaconda`的安装包等等文件，传输到了远程机器进行安装；

安装完毕之后，输入`conda --version`可以成功显示版本号。之后就要迁移`conda`环境了。

### 迁移虚拟环境

首先用 `conda env list` 查看本地 `conda` 虚拟环境都存储在了哪里，然后将这个文件夹传送到远程机器上去。


