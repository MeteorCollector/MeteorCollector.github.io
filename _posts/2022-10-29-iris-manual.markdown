---
layout: post
title:  "一个reader-friendly的iris手册"
date:   2022-10-29 00:12:00 +0800
categories: posts
tag: iris
---

<p><img src="{{site.url}}/images/iris_star.jpg" width="80%" align="middle" /></p>

# iris指令集

## 铱之皮套
或许你可以到[这里](https://meteorcollector.github.io/2023/02/iris-l2d/)看看铱之皮套。

## 免责声明
iris的群友们通过iris获得的所有内容均为**自动生成**，与iris的观点**完全无关**。请在知晓这一点的前提下与iris进行互动。

## 规则怪谈
目前iris的天文竞赛功能在**1000人以上**的群聊中不甚稳定。如果iris不幸崩溃，请第一时间联系她的监护人。

另外，iris天文竞赛的**时钟**运行得也不甚稳定。如果时钟停止运行，也请第一时间联系她的监护人。

## 征集公告
iris长期征集天文题库。详见 [这篇文章]({{site.url}}}/2022/08/the-birth-of-iris/) 的“天文竞赛”一节。

## 重要提醒

在这里对一些使用者经常犯的错误进行**特殊提醒（每一条都很重要）**：

1. 指令字段之间要**加空格**。指令字段之间要**加空格**。指令字段之间要**加空格**。例如：`iris 发 星图 秦皇岛` 之间的空格并不是为了排版显示好看，而是**真的要打空格**。如果说得更明显一些，你应该输入`iris<空格>发<空格>星图<空格>秦皇岛`（不包括引号和尖括号）；
2. 下面示例中的尖括号“<>”仅仅是在提示你这里应该输入一个变量，**而不是**提醒你输入的时候要加尖括号；好比说你要查询恒星“长沙”的信息，`iris 发 恒星 <arg>` 指令的使用方法**并不是**让你输入 `iris 发 恒星 <长沙> `，而是应当输入： `iris 发 恒星 长沙 `。**请把括号去掉**；
3. 如果实在拿不准要输入什么，可以**直接复制示例指令**进行尝试，不要自己穷举语法；
4. 对iris友善一些，毕竟她对你真的很有耐心。

## ! 更重要的提醒 !

请**确保**你已经记住了**“重要提醒”**中的内容再继续阅读。

## iris 发

#### **iris 发 土豆**
发送土豆（猫）；

#### **iris 发 柴郡猫**
发送柴郡猫；

#### **iris 发 \<catalogue\> \<arg\>**
发送深空天体；支持全部NGC星表、IC星表、梅西耶星表；

示例： `iris 发 NGC7023`    `iris 发 M104`

若参数args缺省，则随机发送天体；

示例：`iris 发 IC`	

#### **iris 发 恒星 \<arg\>**
发送恒星数据（暂不支持实施方位角查询）；支持全部HIP星表、HD星表、Gliese星表、Bayer命名法（暂不支持希腊字母，需要转为英文），并且支持部分中文星名；

示例： `iris 发 恒星 omi Cet`	`iris 发 恒星 17 Tau`    `iris 发 恒星 蒭藁增二`	`iris 发 恒星 HIP10826`	`iris 发 恒星 HD14386`

#### **iris 发 APOD \<arg\>**
发送nasa每日天文一图；args格式为严格的YYYY-MM-DD，用于确定特定日期；

示例：`iris 发 APOD`	`iris 发 APOD 2022-08-24`

若参数args缺省，发送最新图片；

若参数不合法，iris不响应；

若发送 `iris 发 APOD 随机`，iris随机发送一张APOD并省略介绍；

#### **iris 发 地球 \<date\>**
发送EPIC地球卫星图像；args格式为严格的YYYY-MM-DD，用于确定特定日期；

示例：`iris 发 地球`	`iris 发 地球 2020-08-14`

若参数args缺省或不合法，发送最新图片；

#### **iris 发 太阳 \<arg\> \<arg\>**
若传入城市名参数，发送太阳运行信息（来自heavens-above）；若参数缺省，默认南京；

示例：`iris 发 太阳 湘潭`	`iris 发 太阳`

若传入SOHO参数，发送SOHO近实时太阳卫星图像；

示例：`iris 发 太阳 SOHO`    `iris 发 太阳 SOHO C2`    `iris 发 太阳 SOHO C3`

传入C2，获得C2相机图像；C3同理；

#### **iris 发 坐标 \<addr\>**

传入地址参数，假若传入的是城市名且该城市名包含在iris的地名库内，将返回iris地名库终该城市的经纬度；否则发送百度api支持的该地址对应经纬度。同时会发送两幅不同比例尺的以该坐标为中心的地图。

示例：`iris 发 坐标 华蓥`     `iris 发 坐标 昌黎`    `iris 发 坐标 上海市宛平南路600号`

你可以使用这一功能验证坐标返回的正确性。其他需要传入地址的功能返回经纬度的逻辑与该功能皆相同。

#### **iris 发 月球/月亮 \<addr\>**
若传入地址参数，发送月球运行信息（来自heavens-above）；若参数缺省，默认南京；

示例：`iris 发 月球 阿勒泰`	`iris 发 月亮`    `iris 发 月球 宋站镇`

#### **iris 发 星图 \<addr\>**
若传入地址参数，发送该地址实时星图（来自heavens-above）；若参数缺省，默认南京；

示例：`iris 发 星图 秦皇岛`	`iris 发 星图`    `iris 发 星图 然日卡`

#### **iris 发 星座 \<星座名\>**

传入星座中文名或缩写，返回该星座星图；

示例：`iris 发 星座 猎户座`    `iris 发 星座 南十字座`     `iris 发 星座 UMi`     `iris 发 星座 PsA`

#### **iris 发 行星 \<arg\> \<addr\>**
若传入行星名与地址两个参数，发送太阳系内行星（以及冥王星）在当地的运行信息（来自heavens-above）；若参数缺省，默认南京；

示例：`iris 发 行星 水星 安庆`	`iris 发 行星 冥王星 景洪`    `iris 发 行星 金星 哈工大`

该指令可以压缩。对于太阳系内行星，可以省去“行星”一节；

示例：`iris 发 火星 青铜峡`	`iris 发 天王星 南京`    `iris 发 水星 南市荣吉大街瑞福里四号`

#### **iris 发 人造卫星/人造天体 \<arg\> \<addr\>**
若传入人造天体名与地址两个参数，发送人造天体在当地的过境信息（来自heavens-above）；若参数缺省，默认南京；（注意，该功能目前仅支持国际空间站和中国空间站）

示例：`iris 发 人造卫星 ISS 丁字沽12号楼4门301`	`iris 发 人造天体 中国空间站 太原`

该指令可以压缩。对于ISS和CSS，可以省去“人造卫星/人造天体”一节；

示例：`iris 发 国际空间站 石家庄`	`iris 发 CSS 酒泉`

#### **iris 发 太阳系**

获得太阳系天体实时位置（来源：heavens-above）；



#### **iris 发 雷达 \<arg\>**
发送中央气象台实时雷达图片，目前仅支持部分雷达站；

示例：`iris 发 雷达 全国`	`iris 发 雷达 华东`	`iris 发 雷达 西安`	`iris 发 雷达 巴中`	`iris 发 雷达 黑瞎子岛`



#### **iris 发 天气 站点/站号 \<站点编号/站点名\>**

如果传入WMO编号，发送指定气象站点详细信息，包括WMO编号、站点名称、所在市、地理位置，并返回一张该位置附近地图。

如果传入地名，发送全部相关气象站点详细信息，包括WMO编号、站点名称、经纬度。

该指令可以压缩：`iris 发 站点 <站点编号/站点名>`

示例：`iris 发 站点 兴隆`   `iris 发 站点 54517`    `iris 发 天气 站点 丰润`    `iris 发 站号 西安`

#### **iris 发 天气 实况 \<站点编号/站点名\>**

发送指定气象站点当前天气数据。

该指令可以压缩 ：`iris 发 天气 <站点编号/站点名>`

示例：`iris 发 天气 休宁`    `iris 发 天气 50137 `    `iris 发 天气 实况 抚宁`

#### **iris 发 天气 24h \<站点编号/站点名\>**

发送指定气象站点过去24小时天气数据。

该指令有变体：`iris 发 天气 24 <站点编号/站点名>`    `iris 发 天气 24小时 <站点编号/站点名>`

示例：`iris 发 天气 24h 六合`    `iris 发 天气 24 59134    `    `iris 发 天气 24小时 塘沽`

#### **iris 发 天气 预报 \<站点编号/站点名\>**

发送指定气象站点未来八天天气预报。

该指令有变体：`iris 发 天气预报 <站点编号/站点名>` 

示例：`iris 发 天气预报 铁岭`    `iris 发 天气预报 56257`



*发天气系列的天气数据数据来自网站[https://q-weather.info/](https://q-weather.info/)，感谢网站作者的整理。*

*注意，使用站名可以查询到的站点可能少于使用编号可以查询到的站点。另外，暂不支持国外和港澳台地区站点。*



#### **iris 发 iris**
那你可是真闲。



## iris tex

基于iris本地环境的LaTeX公式图片生成功能（目前默认白色背景，因为透明背景在手机qq上打开根本看不见），在群聊和私聊中都可以使用。

指令打成`tex`,  `Tex`, `latex`, `Latex`, `LaTeX`均可以识别。

示例：

`iris tex i\hbar\frac{\partial \psi}{\partial {t}} = \frac{-\hbar^2}{2m} \left( \frac{\partial^2}{\partial {x^2}} + \frac{\partial^2}{\partial {y^2}} + \frac{\partial^2}{\partial {z^2}} \right) \psi + V \psi `

`iris tex \begin{aligned}dQ=dU+pdV&\Rightarrow(C_m-C_{V,m})dT=pdV;\\pdV+Vdp=RdT&\Rightarrow(\dfrac {C_m-C_{V,m}}{R})(pdV+Vdp)=pdV;\\C_{p,m}=C_{V,m}+R&\Rightarrow(C_m-C_{p,m})\dfrac {dV}V+(C_m-C_{V,m})\dfrac {dp}p=0;\\pV^n=Const&\Rightarrow n=\dfrac{C_m-C_{p,m}}{C_m-C_{V,m}};\\C_{p,m}=\dfrac{\gamma}{\gamma-1}R,C_{V,m}=\dfrac{1}{\gamma-1}R&\Rightarrow C_m=\dfrac{n-\gamma}{(n-1)(\gamma-1)}R\\&\Rightarrow C_m=C_{V,m}\dfrac{\gamma-n}{1-n}.\end{aligned}` (credit: mike3090)

现在已经支持发送的信息中换行。另外，关于LaTeX公式生成，推荐[这个网站](https://www.latexlive.com)。

## iris 今日运势

普普通通的花哨占卜小功能，请勿迷信！在群聊或者私聊中发送 `iris 今日运势` 即可唤起。

*感谢 minokawa 在python部分debug时提供的重要帮助*

## iris 填字

匹配规则：

>N -> 随机一位数字
>
>M -> 随机数字，范围[1, 12]
>
>D -> 随机数字，范围[1, 31]
>
>H -> 随机大写十六进制数码，范围[0, F] (Hu与其效果相同)
>
>Hl -> 随机小写十六进制数码，范围[0, f]
>
>A -> 随机一级汉字
>
>B -> 随机二级汉字
>
>Q -> 随机中国地级行政单位名称
>
>R -> 随机中国县级行政单位名称
>
>X -> 随机中国姓氏
>
>[l_bound:h_bound] -> 随机数，范围[l_bound, h_bound]
>
>限定符：在A, B, Q, R, X后添加小写字母，则脚标相同的相应字母替换内容在同一条内保持一致
>
>转义符：反斜杠后的大写字母不会被替换。例如\A，\Q等

示例1：
```
	iris 填字 Qa大学将在周[1:7]解封并执行NN小时核酸查验制度，请全体同学注意QaAA码信息，及时上报。另外，请于M月D日之前到达过Q、Q、Q的同学主动联系辅导员。
```
返回1：
```
	兰州大学将在周2解封并执行74小时核酸查验制度，请全体同学注意兰州戎衍码信息，及时上报。另外，请于5月18日之前到达过邢台、晋中、庆阳的同学主动联系辅导员。
```
示例2：
```
	iris 填字 Ai情就是命令，防Ai就是责任
```
返回2：
```
	你情就是命令，防你就是责任
```
示例3：
```
	iris 填字 SS\R RA人XAA QAA寺
```
返回3：
```
	SSR 浦口能人艾携猴 商洛唐廷寺
```

*特别鸣谢：iris的好姐姐🐟姐贵在姓氏库、县级行政单位库所做的贡献。*

## iris 天竞

### **赛制介绍**
#### **旧赛制**
>每一场竞赛最多容纳5位选手，共5题；
>
>输入 'iris 天竞' 开始一场新的知识竞赛；
>输入 'iris 天竞报名' 进行报名；
>
>每一道题，每位选手有且仅有一次回答机会，首名答对出现或者全部参赛选手答完后或者60s内无人答对则进行下一题，共五题，答对加五分，答错倒扣五分；
>
>参赛选手可以回答 P 来跳过一道题；

#### **新赛制**
>每一场竞赛最多容纳选手数量不设上限，共5题；
>
>输入 'iris 天竞' 开始一场新的知识竞赛；
>输入 'iris 天竞 开始比赛' 正式开始；
>
>每一道题，每位选手有且仅有一次回答机会，首名答对出现或者30s内无人答对则进行下一题，共五题，答对加五分，答错倒扣五分；
>
>已经回答过某道题的参赛选手可以回答 P 来跳过该题；

### **指令列表**
#### **iris 天竞**
开始一场新的天文知识竞赛。如果该群已经有竞赛进行中，则无法开始新竞赛；默认采用新赛制；

使用“iris 天竞 旧”开始旧赛制比赛；

#### **iris 天竞 报名**
报名当前天文知识竞赛（仅旧赛制）；

#### **iris 天竞 开始比赛**
使当前比赛报名阶段结束，进入答题阶段。至少需要1名选手开始竞赛；

#### **iris 天竞 终止比赛**
强制终止一场进行中的知识竞赛；

#### **iris 天竞 -h (iris 天竞 --help)**
输出关于天文竞赛方面的帮助信息，包括赛制和指令等；

#### **iris 天竞 排名**
发送该群聊的天竞积分排名；

#### **iris 天竞 排名 清空/重置**
清零该群聊的天竞积分排名（需要管理员权限）。

*特别鸣谢：isor 与 sirius 在天竞题库方面所做的贡献*。

## iris 猜天体

在猜天体中，参赛选手根据图片回答答案。注意在回答之前加入全角句号，否则不会被识别；而且要回答完整，不要只回答空缺的字符。（示例：。鸢尾花星云）

>每一场竞赛最多容纳选手数量不设上限，共5题；
>
>输入 'iris 猜天体' 开始一场新的猜天体竞赛；
>输入 'iris 猜天体 开始比赛' 正式开始；
>
>每一道题，每位选手有无限次回答机会，首名答对出现或者90s内无人答对则进行下一题，共五题，答对加五分，答错不扣分；
>
>已经回答过某道题的参赛选手可以回答 P 来跳过该题；

### **指令列表**
#### **iris 猜天体**
开始一场新的猜天体。如果该群已经有猜天体竞赛进行中，则无法开始新竞赛；

#### **iris 猜天体 开始比赛**
使当前猜天体报名阶段结束，进入答题阶段。

#### **iris 猜天体 终止比赛**
强制终止一场进行中的猜天体；

#### **iris 猜天体 -h  (iris 猜天体 --help)**
输出关于猜天体方面的帮助信息，包括赛制和指令等；

#### **iris 猜天体 排名**
发送该群聊的猜天体积分排名；

#### **iris 猜天体 排名 清空/重置**
清零该群聊的猜天体积分排名（需要管理员权限）。

## 星空识别

iris的星空识别基于网站[https://nova.astrometry.net/](https://nova.astrometry.net/)

可以识别出来的星空基本都是正确的，但是如果照片后期处理幅度很大（例如一些星野照片中会调整一些星星的亮度，尤其是在处理银河时）、或者拍摄条件不是很好（例如星点太少或者有太多云和遮挡物）、拍摄条件特殊（例如很奇怪的波段或者填色），很有可能无法识别。

`ris 认星星/认星 <图片>`用来提交图片进行识别，请勿滥用。

如果提交成功，会返回一个subid。你可以用 `iris 认星星/认星 查询 <subid>` 来查询工作状态（工作完成后iris会自动将结果发到群里）；

或者你可以用 `iris 认星星/认星 -ls` 来查询本群中所有工作的subid

示例：

<p><img src="{{site.url}}/images/StarRecog1.jpg" width="60%" align="middle" /></p>
<p><img src="{{site.url}}/images/StarRecog2.jpg" width="60%" align="middle" /></p>

## 定时消息

iris的定时消息系统用于在**每天同一时间**发送某条消息，指令格式如下：

#### **iris 定时消息 添加 \<24小时制时间\> \<信息内容\>**

用于在本群某时间设置一条定时消息（目前仅支持文本）

`iris 定时消息 添加 0:00 新的一天开始了！`

#### **iris 定时消息 删除 \<信息id\>**
`iris 定时消息 删除 11`

用于删除特定定时消息，请发送 `iris 定时消息 -ls`查看信息id

#### **iris 定时消息 -ls/--list**
用于查看该群聊已经设置的定时消息

#### **iris 定时消息 -h**

用于输出关于定时消息的帮助信息

目前仅有管理员具有相关权限。

## 欢迎消息

iris的欢迎消息系统用于在萌新进群时发送某条消息，当群内设置了多于一条欢迎消息时，会随机选择一条发送。指令格式如下：

#### **iris 欢迎消息 添加 \<信息内容\>**

`iris 欢迎消息 添加 欢迎萌新！`

#### **iris 欢迎消息 删除 \<信息id\>**

用于删除特定欢迎消息，可以发送“iris 欢迎消息 -ls”查看id`

#### **iris 欢迎消息 -ls/--list**

用于查看该群聊已经设置的欢迎消息

目前仅有管理员具有相关权限，且仅支持纯文字

## iris的问句应答

群聊中，在功能”应答“开启时（默认开启），iris可以对一般疑问句进行随机应答。

群聊中，在功能”全应答“开启时（默认关闭），iris将基于语料库对所有未识别的语句进行应答。注意，该nlp没有任何机器学习成分，完全基于字符串的相似度从语料库中找到最”相似“的问句，然后返回对应的回答。再注意，iris的语料库是天文特化的，并不能用于闲聊。欢迎同好补充天文知识。语料库的详细信息详见[这个仓库](https://github.com/MeteorCollector/iris_AstroQnA_ZH)。

如若对iris的nlp感兴趣，强烈建议阅读该文章：[iris的nlp之路：章鱼触手与斩龙大剑](https://meteorcollector.github.io/2023/05/iris-fake-nlp/)

## 存图片（为了应对QQ表情包无法保存实现的功能）

大喊“iris 我要存图”，iris会将最近一个图片的网页链接发送出来，进入保存即可。

私聊群聊都可以。

<p><img src="{{site.url}}/images/SendImg1.jpg" width="60%" align="middle" /></p>
<p><img src="{{site.url}}/images/SendImg2.jpg" width="60%" align="middle" /></p>

## 运行维护

#### **iris 开机**
在某群聊打开iris；（需要管理员权限）

#### **iris 关机**
在某群聊使iris休眠；（需要管理员权限）

#### **iris 开 \<arg\>**
在某群聊开启iris的某一大类功能（发，填字，应答，全应答）；（需要管理员权限）

#### **iris 关 \<arg\>**
在某群聊关闭iris的某一大类功能（发，填字，应答，全应答）；（需要管理员权限）

#### **iris -ls (iris --list)**
查询iris在该群聊的指令开关状态；

#### **iris -h (iris --help)**
输出帮助信息；

#### **iris -v (iris --version)**
输出版本信息；

#### **iris -i (iris --info)**
输出没什么用的信息；

#### **iris 小纸条 \<msg\>**
向iris的监护人打小报告，可以反馈一些bug

示例：
```
	iris 小纸条 为什么iris不理我了QAQ
```
iris的监护人会收到该消息：
```
	收到来自“秦皇岛源码实验室 (111111111)”中“伪电气白兰”的反馈:
为什么iris不理我了QAQ
```

## Q&A

#### **为什么我私聊iris她却不理我？**
iris的功能集中在群聊，自然不会对私聊作出反应。目前私聊只支持一般疑问句随机回答、填字、tex图片生成，以及`iris 唱歌`;

更新：nlp更新后，iris已经可以对私聊进行回答，不过回答比较混沌，请见谅。注意，”发“功能仍然没有在私聊中实装。

#### **iris的形象是谁设计的？**
主要是iris自己。我和群友们通过提问让iris自己选择了这个形象。在设定稿绘制过程中，群友们的集体创作占主导，非常感谢大家。此后我们用novelai生成了很多iris的图片，因此目前为止iris的很多图像是ai生成（当然我自己也画了不少了）；

#### **为什么指令要加空格？这样不是很麻烦吗？**
如果不加空格，偷懒的是你，麻烦到的是iris。空格在这里起到标点符号的作用。假若存在一系列指令均以相同的字段开头，比如“星图”、“星座”、“星等”甚至是“星”，当你单独键入一个“星”字时，iris无从得知需要执行的具体指令是什么，也不知道后面的参数要从哪里开始算。这就好比你说话不加标点要让别人断句一样，iris恕不接受这样无意义的劳动。

...持续更新中...

最近更新：2023/10/6

<p><img src="{{site.url}}/images/iris_100.png" width="80%" align="middle" /></p>

iris在轨运行100天贺图，过路的末某人绘

<p><img src="{{site.url}}/images/iris_field.jpg" width="80%" align="middle" /></p>

iris在天文观测后的野地中，过路的末某人绘

<p><img src="{{site.url}}/images/iris_dune.jpg" width="80%" align="middle" /></p>

iris在沙丘上挥舞红旗，过路的末某人绘

<p><img src="{{site.url}}/images/iris_200.jpg" width="80%" align="middle" /></p>

iris在轨运行200天贺图，过路的末某人绘

<p><img src="{{site.url}}/images/iris_blue_1.png" width="80%" align="middle" /></p>

<p><img src="{{site.url}}/images/iris_blue_2.png" width="80%" align="middle" /></p>

一些草图，过路的末某人绘

<p><img src="{{site.url}}/images/iris_grey_1.jpg" width="80%" align="middle" /></p>

头像重制，过路的末某人绘